{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "x509_name", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py", "response": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\n\ndef x509_name(**attrs):\n    name = X509Name(_lib.X509_NAME_new())\n    for key in sorted(attrs.keys()):\n        value = attrs[key]\n        _lib.X509_NAME_add_entry_by_txt(name, key.encode(), _lib.MBSTRING_UTF8, value.encode(), -1, -1, 0)\n    return name", "test_code_list": [{"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_type(self):\n        \"\"\"\n            The type of X509Name objects is `X509Name`.\n            \"\"\"\n        name = x509_name()\n        assert isinstance(name, X509Name)\n    \nTestX509Name().test_type()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_attributes(self):\n        \"\"\"\n            `X509Name` instances have attributes for each standard (?)\n            X509Name field.\n            \"\"\"\n        name = x509_name()\n        name.commonName = 'foo'\n        assert name.commonName == 'foo'\n        assert name.CN == 'foo'\n        name.CN = 'baz'\n        assert name.commonName == 'baz'\n        assert name.CN == 'baz'\n        name.commonName = 'bar'\n        assert name.commonName == 'bar'\n        assert name.CN == 'bar'\n        name.CN = 'quux'\n        assert name.commonName == 'quux'\n        assert name.CN == 'quux'\n        assert name.OU is None\n        with pytest.raises(AttributeError):\n            name.foobar\n    \nTestX509Name().test_attributes()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_copy(self):\n        \"\"\"\n            `X509Name` creates a new `X509Name` instance with all the same\n            attributes as an existing `X509Name` instance when called with one.\n            \"\"\"\n        name = x509_name(commonName='foo', emailAddress='bar@example.com')\n        copy = X509Name(name)\n        assert copy.commonName == 'foo'\n        assert copy.emailAddress == 'bar@example.com'\n        copy.commonName = 'baz'\n        assert name.commonName == 'foo'\n        name.emailAddress = 'quux@example.com'\n        assert copy.emailAddress == 'bar@example.com'\n    \nTestX509Name().test_copy()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_repr(self):\n        \"\"\"\n            `repr` passed an `X509Name` instance should return a string containing\n            a description of the type and the NIDs which have been set on it.\n            \"\"\"\n        name = x509_name(commonName='foo', emailAddress='bar')\n        assert repr(name) == \"<X509Name object '/emailAddress=bar/CN=foo'>\"\n    \nTestX509Name().test_repr()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_comparison(self):\n        \"\"\"\n            `X509Name` instances should compare based on their NIDs.\n            \"\"\"\n    \n        def _equality(a, b, assert_true, assert_false):\n            assert_true(a == b)\n            assert_false(a != b)\n            assert_true(b == a)\n            assert_false(b != a)\n    \n        def assert_true(x):\n            assert x\n    \n        def assert_false(x):\n            assert not x\n    \n        def assert_equal(a, b):\n            _equality(a, b, assert_true, assert_false)\n        name = x509_name()\n        assert_equal(name, name)\n        assert_equal(x509_name(), x509_name())\n        assert_equal(x509_name(commonName='foo'), x509_name(commonName='foo'))\n        assert_equal(x509_name(commonName='foo'), x509_name(CN='foo'))\n        assert_equal(x509_name(CN='foo', organizationalUnitName='bar'),\n            x509_name(commonName='foo', OU='bar'))\n    \n        def assert_not_equal(a, b):\n            _equality(a, b, assert_false, assert_true)\n        assert_not_equal(x509_name(CN='foo'), x509_name(CN='bar'))\n        assert_not_equal(x509_name(CN='foo'), x509_name(OU='foo'))\n        assert_not_equal(x509_name(), object())\n    \n        def _inequality(a, b, assert_true, assert_false):\n            assert_true(a < b)\n            assert_true(a <= b)\n            assert_true(b > a)\n            assert_true(b >= a)\n            assert_false(a > b)\n            assert_false(a >= b)\n            assert_false(b < a)\n            assert_false(b <= a)\n    \n        def assert_less_than(a, b):\n            _inequality(a, b, assert_true, assert_false)\n        assert_less_than(x509_name(CN='abc'), x509_name(CN='def'))\n    \n        def assert_greater_than(a, b):\n            _inequality(a, b, assert_false, assert_true)\n        assert_greater_than(x509_name(CN='def'), x509_name(CN='abc'))\n    \n        def assert_raises(a, b):\n            with pytest.raises(TypeError):\n                a < b\n            with pytest.raises(TypeError):\n                a <= b\n            with pytest.raises(TypeError):\n                a > b\n            with pytest.raises(TypeError):\n                a >= b\n        assert_raises(x509_name(), object())\n    \nTestX509Name().test_comparison()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_hash(self):\n        \"\"\"\n            `X509Name.hash` returns an integer hash based on the value of the name.\n            \"\"\"\n        a = x509_name(CN='foo')\n        b = x509_name(CN='foo')\n        assert a.hash() == b.hash()\n        a.CN = 'bar'\n        assert a.hash() != b.hash()\n    \nTestX509Name().test_hash()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_der(self):\n        \"\"\"\n            `X509Name.der` returns the DER encoded form of the name.\n            \"\"\"\n        a = x509_name(CN='foo', C='US')\n        assert a.der(\n            ) == b'0\\x1b1\\x0b0\\t\\x06\\x03U\\x04\\x06\\x13\\x02US1\\x0c0\\n\\x06\\x03U\\x04\\x03\\x0c\\x03foo'\n    \nTestX509Name().test_der()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_get_components(self):\n        \"\"\"\n            `X509Name.get_components` returns a `list` of two-tuples of `str`\n            giving the NIDs and associated values which make up the name.\n            \"\"\"\n        a = x509_name()\n        assert a.get_components() == []\n        a.CN = 'foo'\n        assert a.get_components() == [(b'CN', b'foo')]\n        a.organizationalUnitName = 'bar'\n        assert a.get_components() == [(b'CN', b'foo'), (b'OU', b'bar')]\n    \nTestX509Name().test_get_components()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}], "method_code_mask": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\n\ndef x509_name(**attrs): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "x509_name", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py", "response": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\n\ndef x509_name(**attrs):\n    name = X509Name(_lib.X509_NAME_new())\n    for key in sorted(attrs.keys()):\n        value = attrs[key]\n        _lib.X509_NAME_add_entry_by_txt(name, key.encode(), _lib.MBSTRING_UTF8, value.encode(), -1, -1, 0)\n    return name", "test_code_list": [{"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_type(self):\n        \"\"\"\n            The type of X509Name objects is `X509Name`.\n            \"\"\"\n        name = x509_name()\n        assert isinstance(name, X509Name)\n    \nTestX509Name().test_type()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_attributes(self):\n        \"\"\"\n            `X509Name` instances have attributes for each standard (?)\n            X509Name field.\n            \"\"\"\n        name = x509_name()\n        name.commonName = 'foo'\n        assert name.commonName == 'foo'\n        assert name.CN == 'foo'\n        name.CN = 'baz'\n        assert name.commonName == 'baz'\n        assert name.CN == 'baz'\n        name.commonName = 'bar'\n        assert name.commonName == 'bar'\n        assert name.CN == 'bar'\n        name.CN = 'quux'\n        assert name.commonName == 'quux'\n        assert name.CN == 'quux'\n        assert name.OU is None\n        with pytest.raises(AttributeError):\n            name.foobar\n    \nTestX509Name().test_attributes()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_copy(self):\n        \"\"\"\n            `X509Name` creates a new `X509Name` instance with all the same\n            attributes as an existing `X509Name` instance when called with one.\n            \"\"\"\n        name = x509_name(commonName='foo', emailAddress='bar@example.com')\n        copy = X509Name(name)\n        assert copy.commonName == 'foo'\n        assert copy.emailAddress == 'bar@example.com'\n        copy.commonName = 'baz'\n        assert name.commonName == 'foo'\n        name.emailAddress = 'quux@example.com'\n        assert copy.emailAddress == 'bar@example.com'\n    \nTestX509Name().test_copy()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_repr(self):\n        \"\"\"\n            `repr` passed an `X509Name` instance should return a string containing\n            a description of the type and the NIDs which have been set on it.\n            \"\"\"\n        name = x509_name(commonName='foo', emailAddress='bar')\n        assert repr(name) == \"<X509Name object '/emailAddress=bar/CN=foo'>\"\n    \nTestX509Name().test_repr()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_comparison(self):\n        \"\"\"\n            `X509Name` instances should compare based on their NIDs.\n            \"\"\"\n    \n        def _equality(a, b, assert_true, assert_false):\n            assert_true(a == b)\n            assert_false(a != b)\n            assert_true(b == a)\n            assert_false(b != a)\n    \n        def assert_true(x):\n            assert x\n    \n        def assert_false(x):\n            assert not x\n    \n        def assert_equal(a, b):\n            _equality(a, b, assert_true, assert_false)\n        name = x509_name()\n        assert_equal(name, name)\n        assert_equal(x509_name(), x509_name())\n        assert_equal(x509_name(commonName='foo'), x509_name(commonName='foo'))\n        assert_equal(x509_name(commonName='foo'), x509_name(CN='foo'))\n        assert_equal(x509_name(CN='foo', organizationalUnitName='bar'),\n            x509_name(commonName='foo', OU='bar'))\n    \n        def assert_not_equal(a, b):\n            _equality(a, b, assert_false, assert_true)\n        assert_not_equal(x509_name(CN='foo'), x509_name(CN='bar'))\n        assert_not_equal(x509_name(CN='foo'), x509_name(OU='foo'))\n        assert_not_equal(x509_name(), object())\n    \n        def _inequality(a, b, assert_true, assert_false):\n            assert_true(a < b)\n            assert_true(a <= b)\n            assert_true(b > a)\n            assert_true(b >= a)\n            assert_false(a > b)\n            assert_false(a >= b)\n            assert_false(b < a)\n            assert_false(b <= a)\n    \n        def assert_less_than(a, b):\n            _inequality(a, b, assert_true, assert_false)\n        assert_less_than(x509_name(CN='abc'), x509_name(CN='def'))\n    \n        def assert_greater_than(a, b):\n            _inequality(a, b, assert_false, assert_true)\n        assert_greater_than(x509_name(CN='def'), x509_name(CN='abc'))\n    \n        def assert_raises(a, b):\n            with pytest.raises(TypeError):\n                a < b\n            with pytest.raises(TypeError):\n                a <= b\n            with pytest.raises(TypeError):\n                a > b\n            with pytest.raises(TypeError):\n                a >= b\n        assert_raises(x509_name(), object())\n    \nTestX509Name().test_comparison()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_hash(self):\n        \"\"\"\n            `X509Name.hash` returns an integer hash based on the value of the name.\n            \"\"\"\n        a = x509_name(CN='foo')\n        b = x509_name(CN='foo')\n        assert a.hash() == b.hash()\n        a.CN = 'bar'\n        assert a.hash() != b.hash()\n    \nTestX509Name().test_hash()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_der(self):\n        \"\"\"\n            `X509Name.der` returns the DER encoded form of the name.\n            \"\"\"\n        a = x509_name(CN='foo', C='US')\n        assert a.der(\n            ) == b'0\\x1b1\\x0b0\\t\\x06\\x03U\\x04\\x06\\x13\\x02US1\\x0c0\\n\\x06\\x03U\\x04\\x03\\x0c\\x03foo'\n    \nTestX509Name().test_der()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_get_components(self):\n        \"\"\"\n            `X509Name.get_components` returns a `list` of two-tuples of `str`\n            giving the NIDs and associated values which make up the name.\n            \"\"\"\n        a = x509_name()\n        assert a.get_components() == []\n        a.CN = 'foo'\n        assert a.get_components() == [(b'CN', b'foo')]\n        a.organizationalUnitName = 'bar'\n        assert a.get_components() == [(b'CN', b'foo'), (b'OU', b'bar')]\n    \nTestX509Name().test_get_components()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}], "method_code_mask": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\n\ndef x509_name(**attrs): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "x509_name", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py", "response": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\n\ndef x509_name(**attrs):\n    name = X509Name(_lib.X509_NAME_new())\n    for key in sorted(attrs.keys()):\n        value = attrs[key]\n        _lib.X509_NAME_add_entry_by_txt(name, key.encode('utf-8'), _lib.MBSTRING_UTF8, value.encode('utf-8'), -1, -1, 0)\n    return name", "test_code_list": [{"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_type(self):\n        \"\"\"\n            The type of X509Name objects is `X509Name`.\n            \"\"\"\n        name = x509_name()\n        assert isinstance(name, X509Name)\n    \nTestX509Name().test_type()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_attributes(self):\n        \"\"\"\n            `X509Name` instances have attributes for each standard (?)\n            X509Name field.\n            \"\"\"\n        name = x509_name()\n        name.commonName = 'foo'\n        assert name.commonName == 'foo'\n        assert name.CN == 'foo'\n        name.CN = 'baz'\n        assert name.commonName == 'baz'\n        assert name.CN == 'baz'\n        name.commonName = 'bar'\n        assert name.commonName == 'bar'\n        assert name.CN == 'bar'\n        name.CN = 'quux'\n        assert name.commonName == 'quux'\n        assert name.CN == 'quux'\n        assert name.OU is None\n        with pytest.raises(AttributeError):\n            name.foobar\n    \nTestX509Name().test_attributes()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_copy(self):\n        \"\"\"\n            `X509Name` creates a new `X509Name` instance with all the same\n            attributes as an existing `X509Name` instance when called with one.\n            \"\"\"\n        name = x509_name(commonName='foo', emailAddress='bar@example.com')\n        copy = X509Name(name)\n        assert copy.commonName == 'foo'\n        assert copy.emailAddress == 'bar@example.com'\n        copy.commonName = 'baz'\n        assert name.commonName == 'foo'\n        name.emailAddress = 'quux@example.com'\n        assert copy.emailAddress == 'bar@example.com'\n    \nTestX509Name().test_copy()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_repr(self):\n        \"\"\"\n            `repr` passed an `X509Name` instance should return a string containing\n            a description of the type and the NIDs which have been set on it.\n            \"\"\"\n        name = x509_name(commonName='foo', emailAddress='bar')\n        assert repr(name) == \"<X509Name object '/emailAddress=bar/CN=foo'>\"\n    \nTestX509Name().test_repr()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_comparison(self):\n        \"\"\"\n            `X509Name` instances should compare based on their NIDs.\n            \"\"\"\n    \n        def _equality(a, b, assert_true, assert_false):\n            assert_true(a == b)\n            assert_false(a != b)\n            assert_true(b == a)\n            assert_false(b != a)\n    \n        def assert_true(x):\n            assert x\n    \n        def assert_false(x):\n            assert not x\n    \n        def assert_equal(a, b):\n            _equality(a, b, assert_true, assert_false)\n        name = x509_name()\n        assert_equal(name, name)\n        assert_equal(x509_name(), x509_name())\n        assert_equal(x509_name(commonName='foo'), x509_name(commonName='foo'))\n        assert_equal(x509_name(commonName='foo'), x509_name(CN='foo'))\n        assert_equal(x509_name(CN='foo', organizationalUnitName='bar'),\n            x509_name(commonName='foo', OU='bar'))\n    \n        def assert_not_equal(a, b):\n            _equality(a, b, assert_false, assert_true)\n        assert_not_equal(x509_name(CN='foo'), x509_name(CN='bar'))\n        assert_not_equal(x509_name(CN='foo'), x509_name(OU='foo'))\n        assert_not_equal(x509_name(), object())\n    \n        def _inequality(a, b, assert_true, assert_false):\n            assert_true(a < b)\n            assert_true(a <= b)\n            assert_true(b > a)\n            assert_true(b >= a)\n            assert_false(a > b)\n            assert_false(a >= b)\n            assert_false(b < a)\n            assert_false(b <= a)\n    \n        def assert_less_than(a, b):\n            _inequality(a, b, assert_true, assert_false)\n        assert_less_than(x509_name(CN='abc'), x509_name(CN='def'))\n    \n        def assert_greater_than(a, b):\n            _inequality(a, b, assert_false, assert_true)\n        assert_greater_than(x509_name(CN='def'), x509_name(CN='abc'))\n    \n        def assert_raises(a, b):\n            with pytest.raises(TypeError):\n                a < b\n            with pytest.raises(TypeError):\n                a <= b\n            with pytest.raises(TypeError):\n                a > b\n            with pytest.raises(TypeError):\n                a >= b\n        assert_raises(x509_name(), object())\n    \nTestX509Name().test_comparison()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_hash(self):\n        \"\"\"\n            `X509Name.hash` returns an integer hash based on the value of the name.\n            \"\"\"\n        a = x509_name(CN='foo')\n        b = x509_name(CN='foo')\n        assert a.hash() == b.hash()\n        a.CN = 'bar'\n        assert a.hash() != b.hash()\n    \nTestX509Name().test_hash()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_der(self):\n        \"\"\"\n            `X509Name.der` returns the DER encoded form of the name.\n            \"\"\"\n        a = x509_name(CN='foo', C='US')\n        assert a.der(\n            ) == b'0\\x1b1\\x0b0\\t\\x06\\x03U\\x04\\x06\\x13\\x02US1\\x0c0\\n\\x06\\x03U\\x04\\x03\\x0c\\x03foo'\n    \nTestX509Name().test_der()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_get_components(self):\n        \"\"\"\n            `X509Name.get_components` returns a `list` of two-tuples of `str`\n            giving the NIDs and associated values which make up the name.\n            \"\"\"\n        a = x509_name()\n        assert a.get_components() == []\n        a.CN = 'foo'\n        assert a.get_components() == [(b'CN', b'foo')]\n        a.organizationalUnitName = 'bar'\n        assert a.get_components() == [(b'CN', b'foo'), (b'OU', b'bar')]\n    \nTestX509Name().test_get_components()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}], "method_code_mask": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\n\ndef x509_name(**attrs): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "x509_name", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py", "response": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\n\ndef x509_name(**attrs):\n    name = X509Name(_lib.X509_NAME_new())\n    for key in sorted(attrs.keys()):\n        value = attrs[key]\n        _lib.X509_NAME_add_entry_by_txt(name, key.encode(), _lib.ASN1_STRING_TYPE, value.encode(), -1, -1, 0)\n    return name", "test_code_list": [{"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_type(self):\n        \"\"\"\n            The type of X509Name objects is `X509Name`.\n            \"\"\"\n        name = x509_name()\n        assert isinstance(name, X509Name)\n    \nTestX509Name().test_type()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_attributes(self):\n        \"\"\"\n            `X509Name` instances have attributes for each standard (?)\n            X509Name field.\n            \"\"\"\n        name = x509_name()\n        name.commonName = 'foo'\n        assert name.commonName == 'foo'\n        assert name.CN == 'foo'\n        name.CN = 'baz'\n        assert name.commonName == 'baz'\n        assert name.CN == 'baz'\n        name.commonName = 'bar'\n        assert name.commonName == 'bar'\n        assert name.CN == 'bar'\n        name.CN = 'quux'\n        assert name.commonName == 'quux'\n        assert name.CN == 'quux'\n        assert name.OU is None\n        with pytest.raises(AttributeError):\n            name.foobar\n    \nTestX509Name().test_attributes()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_copy(self):\n        \"\"\"\n            `X509Name` creates a new `X509Name` instance with all the same\n            attributes as an existing `X509Name` instance when called with one.\n            \"\"\"\n        name = x509_name(commonName='foo', emailAddress='bar@example.com')\n        copy = X509Name(name)\n        assert copy.commonName == 'foo'\n        assert copy.emailAddress == 'bar@example.com'\n        copy.commonName = 'baz'\n        assert name.commonName == 'foo'\n        name.emailAddress = 'quux@example.com'\n        assert copy.emailAddress == 'bar@example.com'\n    \nTestX509Name().test_copy()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_repr(self):\n        \"\"\"\n            `repr` passed an `X509Name` instance should return a string containing\n            a description of the type and the NIDs which have been set on it.\n            \"\"\"\n        name = x509_name(commonName='foo', emailAddress='bar')\n        assert repr(name) == \"<X509Name object '/emailAddress=bar/CN=foo'>\"\n    \nTestX509Name().test_repr()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_comparison(self):\n        \"\"\"\n            `X509Name` instances should compare based on their NIDs.\n            \"\"\"\n    \n        def _equality(a, b, assert_true, assert_false):\n            assert_true(a == b)\n            assert_false(a != b)\n            assert_true(b == a)\n            assert_false(b != a)\n    \n        def assert_true(x):\n            assert x\n    \n        def assert_false(x):\n            assert not x\n    \n        def assert_equal(a, b):\n            _equality(a, b, assert_true, assert_false)\n        name = x509_name()\n        assert_equal(name, name)\n        assert_equal(x509_name(), x509_name())\n        assert_equal(x509_name(commonName='foo'), x509_name(commonName='foo'))\n        assert_equal(x509_name(commonName='foo'), x509_name(CN='foo'))\n        assert_equal(x509_name(CN='foo', organizationalUnitName='bar'),\n            x509_name(commonName='foo', OU='bar'))\n    \n        def assert_not_equal(a, b):\n            _equality(a, b, assert_false, assert_true)\n        assert_not_equal(x509_name(CN='foo'), x509_name(CN='bar'))\n        assert_not_equal(x509_name(CN='foo'), x509_name(OU='foo'))\n        assert_not_equal(x509_name(), object())\n    \n        def _inequality(a, b, assert_true, assert_false):\n            assert_true(a < b)\n            assert_true(a <= b)\n            assert_true(b > a)\n            assert_true(b >= a)\n            assert_false(a > b)\n            assert_false(a >= b)\n            assert_false(b < a)\n            assert_false(b <= a)\n    \n        def assert_less_than(a, b):\n            _inequality(a, b, assert_true, assert_false)\n        assert_less_than(x509_name(CN='abc'), x509_name(CN='def'))\n    \n        def assert_greater_than(a, b):\n            _inequality(a, b, assert_false, assert_true)\n        assert_greater_than(x509_name(CN='def'), x509_name(CN='abc'))\n    \n        def assert_raises(a, b):\n            with pytest.raises(TypeError):\n                a < b\n            with pytest.raises(TypeError):\n                a <= b\n            with pytest.raises(TypeError):\n                a > b\n            with pytest.raises(TypeError):\n                a >= b\n        assert_raises(x509_name(), object())\n    \nTestX509Name().test_comparison()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_hash(self):\n        \"\"\"\n            `X509Name.hash` returns an integer hash based on the value of the name.\n            \"\"\"\n        a = x509_name(CN='foo')\n        b = x509_name(CN='foo')\n        assert a.hash() == b.hash()\n        a.CN = 'bar'\n        assert a.hash() != b.hash()\n    \nTestX509Name().test_hash()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_der(self):\n        \"\"\"\n            `X509Name.der` returns the DER encoded form of the name.\n            \"\"\"\n        a = x509_name(CN='foo', C='US')\n        assert a.der(\n            ) == b'0\\x1b1\\x0b0\\t\\x06\\x03U\\x04\\x06\\x13\\x02US1\\x0c0\\n\\x06\\x03U\\x04\\x03\\x0c\\x03foo'\n    \nTestX509Name().test_der()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_get_components(self):\n        \"\"\"\n            `X509Name.get_components` returns a `list` of two-tuples of `str`\n            giving the NIDs and associated values which make up the name.\n            \"\"\"\n        a = x509_name()\n        assert a.get_components() == []\n        a.CN = 'foo'\n        assert a.get_components() == [(b'CN', b'foo')]\n        a.organizationalUnitName = 'bar'\n        assert a.get_components() == [(b'CN', b'foo'), (b'OU', b'bar')]\n    \nTestX509Name().test_get_components()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}], "method_code_mask": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\n\ndef x509_name(**attrs): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "x509_name", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py", "response": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\n\ndef x509_name(**attrs):\n    name = X509Name(_lib.X509_NAME_new())\n    for key in sorted(attrs.keys()):\n        value = attrs[key]\n        _lib.X509_NAME_add_entry_by_txt(name, key.encode(), _lib.MBSTRING_UTF8, value.encode(), -1, -1, 0)\n    return name", "test_code_list": [{"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_type(self):\n        \"\"\"\n            The type of X509Name objects is `X509Name`.\n            \"\"\"\n        name = x509_name()\n        assert isinstance(name, X509Name)\n    \nTestX509Name().test_type()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_attributes(self):\n        \"\"\"\n            `X509Name` instances have attributes for each standard (?)\n            X509Name field.\n            \"\"\"\n        name = x509_name()\n        name.commonName = 'foo'\n        assert name.commonName == 'foo'\n        assert name.CN == 'foo'\n        name.CN = 'baz'\n        assert name.commonName == 'baz'\n        assert name.CN == 'baz'\n        name.commonName = 'bar'\n        assert name.commonName == 'bar'\n        assert name.CN == 'bar'\n        name.CN = 'quux'\n        assert name.commonName == 'quux'\n        assert name.CN == 'quux'\n        assert name.OU is None\n        with pytest.raises(AttributeError):\n            name.foobar\n    \nTestX509Name().test_attributes()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_copy(self):\n        \"\"\"\n            `X509Name` creates a new `X509Name` instance with all the same\n            attributes as an existing `X509Name` instance when called with one.\n            \"\"\"\n        name = x509_name(commonName='foo', emailAddress='bar@example.com')\n        copy = X509Name(name)\n        assert copy.commonName == 'foo'\n        assert copy.emailAddress == 'bar@example.com'\n        copy.commonName = 'baz'\n        assert name.commonName == 'foo'\n        name.emailAddress = 'quux@example.com'\n        assert copy.emailAddress == 'bar@example.com'\n    \nTestX509Name().test_copy()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_repr(self):\n        \"\"\"\n            `repr` passed an `X509Name` instance should return a string containing\n            a description of the type and the NIDs which have been set on it.\n            \"\"\"\n        name = x509_name(commonName='foo', emailAddress='bar')\n        assert repr(name) == \"<X509Name object '/emailAddress=bar/CN=foo'>\"\n    \nTestX509Name().test_repr()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_comparison(self):\n        \"\"\"\n            `X509Name` instances should compare based on their NIDs.\n            \"\"\"\n    \n        def _equality(a, b, assert_true, assert_false):\n            assert_true(a == b)\n            assert_false(a != b)\n            assert_true(b == a)\n            assert_false(b != a)\n    \n        def assert_true(x):\n            assert x\n    \n        def assert_false(x):\n            assert not x\n    \n        def assert_equal(a, b):\n            _equality(a, b, assert_true, assert_false)\n        name = x509_name()\n        assert_equal(name, name)\n        assert_equal(x509_name(), x509_name())\n        assert_equal(x509_name(commonName='foo'), x509_name(commonName='foo'))\n        assert_equal(x509_name(commonName='foo'), x509_name(CN='foo'))\n        assert_equal(x509_name(CN='foo', organizationalUnitName='bar'),\n            x509_name(commonName='foo', OU='bar'))\n    \n        def assert_not_equal(a, b):\n            _equality(a, b, assert_false, assert_true)\n        assert_not_equal(x509_name(CN='foo'), x509_name(CN='bar'))\n        assert_not_equal(x509_name(CN='foo'), x509_name(OU='foo'))\n        assert_not_equal(x509_name(), object())\n    \n        def _inequality(a, b, assert_true, assert_false):\n            assert_true(a < b)\n            assert_true(a <= b)\n            assert_true(b > a)\n            assert_true(b >= a)\n            assert_false(a > b)\n            assert_false(a >= b)\n            assert_false(b < a)\n            assert_false(b <= a)\n    \n        def assert_less_than(a, b):\n            _inequality(a, b, assert_true, assert_false)\n        assert_less_than(x509_name(CN='abc'), x509_name(CN='def'))\n    \n        def assert_greater_than(a, b):\n            _inequality(a, b, assert_false, assert_true)\n        assert_greater_than(x509_name(CN='def'), x509_name(CN='abc'))\n    \n        def assert_raises(a, b):\n            with pytest.raises(TypeError):\n                a < b\n            with pytest.raises(TypeError):\n                a <= b\n            with pytest.raises(TypeError):\n                a > b\n            with pytest.raises(TypeError):\n                a >= b\n        assert_raises(x509_name(), object())\n    \nTestX509Name().test_comparison()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_hash(self):\n        \"\"\"\n            `X509Name.hash` returns an integer hash based on the value of the name.\n            \"\"\"\n        a = x509_name(CN='foo')\n        b = x509_name(CN='foo')\n        assert a.hash() == b.hash()\n        a.CN = 'bar'\n        assert a.hash() != b.hash()\n    \nTestX509Name().test_hash()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_der(self):\n        \"\"\"\n            `X509Name.der` returns the DER encoded form of the name.\n            \"\"\"\n        a = x509_name(CN='foo', C='US')\n        assert a.der(\n            ) == b'0\\x1b1\\x0b0\\t\\x06\\x03U\\x04\\x06\\x13\\x02US1\\x0c0\\n\\x06\\x03U\\x04\\x03\\x0c\\x03foo'\n    \nTestX509Name().test_der()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}, {"test_code": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\nclass TestX509Name():\n    def test_get_components(self):\n        \"\"\"\n            `X509Name.get_components` returns a `list` of two-tuples of `str`\n            giving the NIDs and associated values which make up the name.\n            \"\"\"\n        a = x509_name()\n        assert a.get_components() == []\n        a.CN = 'foo'\n        assert a.get_components() == [(b'CN', b'foo')]\n        a.organizationalUnitName = 'bar'\n        assert a.get_components() == [(b'CN', b'foo'), (b'OU', b'bar')]\n    \nTestX509Name().test_get_components()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_crypto.py"}], "method_code_mask": "import base64\nimport sys\nimport warnings\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom datetime import timezone\nfrom subprocess import PIPE\nfrom subprocess import Popen\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives.asymmetric import ed448\nfrom cryptography.hazmat.primitives.asymmetric import ed25519\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_ASN1\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import FILETYPE_TEXT\nfrom OpenSSL.crypto import TYPE_DSA\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import Error\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Name\nfrom OpenSSL.crypto import X509Req\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import X509StoreContext\nfrom OpenSSL.crypto import X509StoreContextError\nfrom OpenSSL.crypto import X509StoreFlags\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_certificate_request\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import dump_publickey\nfrom OpenSSL.crypto import get_elliptic_curve\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_certificate_request\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import load_publickey\nfrom OpenSSL.crypto import sign\nfrom OpenSSL.crypto import verify\nfrom OpenSSL.crypto import CRL\nfrom OpenSSL.crypto import Revoked\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.crypto import dump_crl\nfrom OpenSSL.crypto import load_crl\nfrom cryptography.x509.extensions import CRLReason\nfrom cryptography.x509.extensions import ReasonFlags\n\n\ndef x509_name(**attrs): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "socket_any_family", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef socket_any_family():\n    try:\n        # Try to create an IPv4 socket\n        sock = socket(AF_INET)\n        return sock\n    except OSError as e:\n        if e.errno == EAFNOSUPPORT:\n            # If AF_INET is not supported, try to create an IPv6 socket\n            try:\n                sock = socket(AF_INET6)\n                return sock\n            except OSError:\n                # If neither AF_INET nor AF_INET6 is supported, propagate the exception\n                raise OSError(\"Neither AF_INET nor AF_INET6 is supported on this system.\")\n        else:\n            # If the error is not EAFNOSUPPORT, propagate the exception\n            raise", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef loopback_address(socket):\n    if socket.family == AF_INET:\n        return '127.0.0.1'\n    else:\n        assert socket.family == AF_INET6\n        return '::1'\ndef socket_pair():\n    \"\"\"\n    Establish and return a pair of network sockets connected to each other.\n    \"\"\"\n    port = socket_any_family()\n    port.bind(('', 0))\n    port.listen(1)\n    client = socket(port.family)\n    client.setblocking(False)\n    client.connect_ex((loopback_address(port), port.getsockname()[1]))\n    client.setblocking(True)\n    server = port.accept()[0]\n    port.close()\n    server.send(b'x')\n    assert client.recv(1024) == b'x'\n    client.send(b'y')\n    assert server.recv(1024) == b'y'\n    server.setblocking(False)\n    client.setblocking(False)\n    return server, client\nsocket_pair()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef loopback_address(socket):\n    if socket.family == AF_INET:\n        return '127.0.0.1'\n    else:\n        assert socket.family == AF_INET6\n        return '::1'\nclass TestConnection():\n    def test_connect_refused(self):\n        \"\"\"\n            `Connection.connect` raises `socket.error` if the underlying socket\n            connect method raises it.\n            \"\"\"\n        client = socket_any_family()\n        context = Context(SSLv23_METHOD)\n        clientSSL = Connection(context, client)\n        try:\n            clientSSL.connect((loopback_address(client), 1))\n        except OSError as e:\n            exc = e\n        assert exc.args[0] == ECONNREFUSED\nTestConnection().test_connect_refused()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_connect_ex(self):\n        \"\"\"\n            If there is a connection error, `Connection.connect_ex` returns the\n            errno instead of raising an exception.\n            \"\"\"\n        port = socket_any_family()\n        port.bind(('', 0))\n        port.listen(3)\n        clientSSL = Connection(Context(SSLv23_METHOD), socket(port.family))\n        clientSSL.setblocking(False)\n        result = clientSSL.connect_ex(port.getsockname())\n        expected = EINPROGRESS, EWOULDBLOCK\n        assert result in expected\n    \nTestConnection().test_connect_ex()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_set_shutdown(self):\n        \"\"\"\n            `Connection.set_shutdown` sets the state of the SSL connection\n            shutdown process.\n            \"\"\"\n        connection = Connection(Context(SSLv23_METHOD), socket_any_family())\n        connection.set_shutdown(RECEIVED_SHUTDOWN)\n        assert connection.get_shutdown() == RECEIVED_SHUTDOWN\n    \nTestConnection().test_set_shutdown()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef socket_any_family(): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "socket_any_family", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef socket_any_family():\n    try:\n        # Attempt to create an IPv4 socket\n        sock = socket(AF_INET)\n        return sock\n    except OSError as e:\n        if e.errno == EAFNOSUPPORT:\n            # If AF_INET is not supported, try to create an IPv6 socket\n            try:\n                sock = socket(AF_INET6)\n                return sock\n            except OSError:\n                # If neither AF_INET nor AF_INET6 is supported, propagate the exception\n                raise OSError(\"Neither AF_INET nor AF_INET6 is supported on this system.\")\n        else:\n            # If the error is not EAFNOSUPPORT, propagate the exception\n            raise", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef loopback_address(socket):\n    if socket.family == AF_INET:\n        return '127.0.0.1'\n    else:\n        assert socket.family == AF_INET6\n        return '::1'\ndef socket_pair():\n    \"\"\"\n    Establish and return a pair of network sockets connected to each other.\n    \"\"\"\n    port = socket_any_family()\n    port.bind(('', 0))\n    port.listen(1)\n    client = socket(port.family)\n    client.setblocking(False)\n    client.connect_ex((loopback_address(port), port.getsockname()[1]))\n    client.setblocking(True)\n    server = port.accept()[0]\n    port.close()\n    server.send(b'x')\n    assert client.recv(1024) == b'x'\n    client.send(b'y')\n    assert server.recv(1024) == b'y'\n    server.setblocking(False)\n    client.setblocking(False)\n    return server, client\nsocket_pair()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef loopback_address(socket):\n    if socket.family == AF_INET:\n        return '127.0.0.1'\n    else:\n        assert socket.family == AF_INET6\n        return '::1'\nclass TestConnection():\n    def test_connect_refused(self):\n        \"\"\"\n            `Connection.connect` raises `socket.error` if the underlying socket\n            connect method raises it.\n            \"\"\"\n        client = socket_any_family()\n        context = Context(SSLv23_METHOD)\n        clientSSL = Connection(context, client)\n        try:\n            clientSSL.connect((loopback_address(client), 1))\n        except OSError as e:\n            exc = e\n        assert exc.args[0] == ECONNREFUSED\nTestConnection().test_connect_refused()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_connect_ex(self):\n        \"\"\"\n            If there is a connection error, `Connection.connect_ex` returns the\n            errno instead of raising an exception.\n            \"\"\"\n        port = socket_any_family()\n        port.bind(('', 0))\n        port.listen(3)\n        clientSSL = Connection(Context(SSLv23_METHOD), socket(port.family))\n        clientSSL.setblocking(False)\n        result = clientSSL.connect_ex(port.getsockname())\n        expected = EINPROGRESS, EWOULDBLOCK\n        assert result in expected\n    \nTestConnection().test_connect_ex()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_set_shutdown(self):\n        \"\"\"\n            `Connection.set_shutdown` sets the state of the SSL connection\n            shutdown process.\n            \"\"\"\n        connection = Connection(Context(SSLv23_METHOD), socket_any_family())\n        connection.set_shutdown(RECEIVED_SHUTDOWN)\n        assert connection.get_shutdown() == RECEIVED_SHUTDOWN\n    \nTestConnection().test_set_shutdown()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef socket_any_family(): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "socket_any_family", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef socket_any_family():\n    try:\n        # Attempt to create a socket with AF_INET (IPv4)\n        sock = socket(AF_INET)\n        return sock\n    except OSError as e:\n        if e.errno == EAFNOSUPPORT:\n            # If AF_INET is not supported, try AF_INET6 (IPv6)\n            try:\n                sock = socket(AF_INET6)\n                return sock\n            except OSError:\n                # If neither AF_INET nor AF_INET6 is supported, propagate the exception\n                raise OSError(\"Neither AF_INET nor AF_INET6 is supported on this system.\")\n        else:\n            # If the error is not EAFNOSUPPORT, propagate the exception\n            raise", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef loopback_address(socket):\n    if socket.family == AF_INET:\n        return '127.0.0.1'\n    else:\n        assert socket.family == AF_INET6\n        return '::1'\ndef socket_pair():\n    \"\"\"\n    Establish and return a pair of network sockets connected to each other.\n    \"\"\"\n    port = socket_any_family()\n    port.bind(('', 0))\n    port.listen(1)\n    client = socket(port.family)\n    client.setblocking(False)\n    client.connect_ex((loopback_address(port), port.getsockname()[1]))\n    client.setblocking(True)\n    server = port.accept()[0]\n    port.close()\n    server.send(b'x')\n    assert client.recv(1024) == b'x'\n    client.send(b'y')\n    assert server.recv(1024) == b'y'\n    server.setblocking(False)\n    client.setblocking(False)\n    return server, client\nsocket_pair()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef loopback_address(socket):\n    if socket.family == AF_INET:\n        return '127.0.0.1'\n    else:\n        assert socket.family == AF_INET6\n        return '::1'\nclass TestConnection():\n    def test_connect_refused(self):\n        \"\"\"\n            `Connection.connect` raises `socket.error` if the underlying socket\n            connect method raises it.\n            \"\"\"\n        client = socket_any_family()\n        context = Context(SSLv23_METHOD)\n        clientSSL = Connection(context, client)\n        try:\n            clientSSL.connect((loopback_address(client), 1))\n        except OSError as e:\n            exc = e\n        assert exc.args[0] == ECONNREFUSED\nTestConnection().test_connect_refused()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_connect_ex(self):\n        \"\"\"\n            If there is a connection error, `Connection.connect_ex` returns the\n            errno instead of raising an exception.\n            \"\"\"\n        port = socket_any_family()\n        port.bind(('', 0))\n        port.listen(3)\n        clientSSL = Connection(Context(SSLv23_METHOD), socket(port.family))\n        clientSSL.setblocking(False)\n        result = clientSSL.connect_ex(port.getsockname())\n        expected = EINPROGRESS, EWOULDBLOCK\n        assert result in expected\n    \nTestConnection().test_connect_ex()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_set_shutdown(self):\n        \"\"\"\n            `Connection.set_shutdown` sets the state of the SSL connection\n            shutdown process.\n            \"\"\"\n        connection = Connection(Context(SSLv23_METHOD), socket_any_family())\n        connection.set_shutdown(RECEIVED_SHUTDOWN)\n        assert connection.get_shutdown() == RECEIVED_SHUTDOWN\n    \nTestConnection().test_set_shutdown()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef socket_any_family(): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "socket_any_family", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef socket_any_family():\n    try:\n        sock = socket(AF_INET)  # Try to create an IPv4 socket\n        return sock\n    except OSError as e:\n        if e.errno == EAFNOSUPPORT:  # If AF_INET is not supported\n            try:\n                sock = socket(AF_INET6)  # Try to create an IPv6 socket\n                return sock\n            except OSError:\n                raise OSError(\"Neither AF_INET nor AF_INET6 is supported on this system.\")\n        else:\n            raise  # Propagate other OSError exceptions", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef loopback_address(socket):\n    if socket.family == AF_INET:\n        return '127.0.0.1'\n    else:\n        assert socket.family == AF_INET6\n        return '::1'\ndef socket_pair():\n    \"\"\"\n    Establish and return a pair of network sockets connected to each other.\n    \"\"\"\n    port = socket_any_family()\n    port.bind(('', 0))\n    port.listen(1)\n    client = socket(port.family)\n    client.setblocking(False)\n    client.connect_ex((loopback_address(port), port.getsockname()[1]))\n    client.setblocking(True)\n    server = port.accept()[0]\n    port.close()\n    server.send(b'x')\n    assert client.recv(1024) == b'x'\n    client.send(b'y')\n    assert server.recv(1024) == b'y'\n    server.setblocking(False)\n    client.setblocking(False)\n    return server, client\nsocket_pair()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef loopback_address(socket):\n    if socket.family == AF_INET:\n        return '127.0.0.1'\n    else:\n        assert socket.family == AF_INET6\n        return '::1'\nclass TestConnection():\n    def test_connect_refused(self):\n        \"\"\"\n            `Connection.connect` raises `socket.error` if the underlying socket\n            connect method raises it.\n            \"\"\"\n        client = socket_any_family()\n        context = Context(SSLv23_METHOD)\n        clientSSL = Connection(context, client)\n        try:\n            clientSSL.connect((loopback_address(client), 1))\n        except OSError as e:\n            exc = e\n        assert exc.args[0] == ECONNREFUSED\nTestConnection().test_connect_refused()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_connect_ex(self):\n        \"\"\"\n            If there is a connection error, `Connection.connect_ex` returns the\n            errno instead of raising an exception.\n            \"\"\"\n        port = socket_any_family()\n        port.bind(('', 0))\n        port.listen(3)\n        clientSSL = Connection(Context(SSLv23_METHOD), socket(port.family))\n        clientSSL.setblocking(False)\n        result = clientSSL.connect_ex(port.getsockname())\n        expected = EINPROGRESS, EWOULDBLOCK\n        assert result in expected\n    \nTestConnection().test_connect_ex()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_set_shutdown(self):\n        \"\"\"\n            `Connection.set_shutdown` sets the state of the SSL connection\n            shutdown process.\n            \"\"\"\n        connection = Connection(Context(SSLv23_METHOD), socket_any_family())\n        connection.set_shutdown(RECEIVED_SHUTDOWN)\n        assert connection.get_shutdown() == RECEIVED_SHUTDOWN\n    \nTestConnection().test_set_shutdown()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef socket_any_family(): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "socket_any_family", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef socket_any_family():\n    try:\n        # Attempt to create a socket with AF_INET (IPv4)\n        sock = socket(AF_INET)\n        return sock\n    except OSError as e:\n        if e.errno == EAFNOSUPPORT:\n            # If AF_INET is not supported, try AF_INET6 (IPv6)\n            try:\n                sock = socket(AF_INET6)\n                return sock\n            except OSError:\n                # If neither AF_INET nor AF_INET6 is supported, propagate the exception\n                raise OSError(\"Neither AF_INET nor AF_INET6 is supported on this system.\")\n        else:\n            # If another OSError occurred, propagate it\n            raise", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef loopback_address(socket):\n    if socket.family == AF_INET:\n        return '127.0.0.1'\n    else:\n        assert socket.family == AF_INET6\n        return '::1'\ndef socket_pair():\n    \"\"\"\n    Establish and return a pair of network sockets connected to each other.\n    \"\"\"\n    port = socket_any_family()\n    port.bind(('', 0))\n    port.listen(1)\n    client = socket(port.family)\n    client.setblocking(False)\n    client.connect_ex((loopback_address(port), port.getsockname()[1]))\n    client.setblocking(True)\n    server = port.accept()[0]\n    port.close()\n    server.send(b'x')\n    assert client.recv(1024) == b'x'\n    client.send(b'y')\n    assert server.recv(1024) == b'y'\n    server.setblocking(False)\n    client.setblocking(False)\n    return server, client\nsocket_pair()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef loopback_address(socket):\n    if socket.family == AF_INET:\n        return '127.0.0.1'\n    else:\n        assert socket.family == AF_INET6\n        return '::1'\nclass TestConnection():\n    def test_connect_refused(self):\n        \"\"\"\n            `Connection.connect` raises `socket.error` if the underlying socket\n            connect method raises it.\n            \"\"\"\n        client = socket_any_family()\n        context = Context(SSLv23_METHOD)\n        clientSSL = Connection(context, client)\n        try:\n            clientSSL.connect((loopback_address(client), 1))\n        except OSError as e:\n            exc = e\n        assert exc.args[0] == ECONNREFUSED\nTestConnection().test_connect_refused()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_connect_ex(self):\n        \"\"\"\n            If there is a connection error, `Connection.connect_ex` returns the\n            errno instead of raising an exception.\n            \"\"\"\n        port = socket_any_family()\n        port.bind(('', 0))\n        port.listen(3)\n        clientSSL = Connection(Context(SSLv23_METHOD), socket(port.family))\n        clientSSL.setblocking(False)\n        result = clientSSL.connect_ex(port.getsockname())\n        expected = EINPROGRESS, EWOULDBLOCK\n        assert result in expected\n    \nTestConnection().test_connect_ex()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_set_shutdown(self):\n        \"\"\"\n            `Connection.set_shutdown` sets the state of the SSL connection\n            shutdown process.\n            \"\"\"\n        connection = Connection(Context(SSLv23_METHOD), socket_any_family())\n        connection.set_shutdown(RECEIVED_SHUTDOWN)\n        assert connection.get_shutdown() == RECEIVED_SHUTDOWN\n    \nTestConnection().test_set_shutdown()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef socket_any_family(): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "interact_in_memory", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef interact_in_memory(client_conn, server_conn):\n    while True:\n        # Read data from client\n        try:\n            client_data = client_conn.recv(4096)\n            if client_data:\n                server_conn.send(client_data)\n                return client_conn, client_data\n        except WantReadError:\n            pass\n        except WantWriteError:\n            pass\n        except ZeroReturnError:\n            break\n\n        # Read data from server\n        try:\n            server_data = server_conn.recv(4096)\n            if server_data:\n                client_conn.send(server_data)\n                return server_conn, server_data\n        except WantReadError:\n            pass\n        except WantWriteError:\n            pass\n        except ZeroReturnError:\n            break\n\n    return None", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\ndef _create_certificate_chain():\n    \"\"\"\n    Construct and return a chain of certificates.\n        1. A new self-signed certificate authority certificate (cacert)\n        2. A new intermediate certificate signed by cacert (icert)\n        3. A new server certificate signed by icert (scert)\n    \"\"\"\n    caext = X509Extension(b'basicConstraints', False, b'CA:true')\n    not_after_date = datetime.date.today() + datetime.timedelta(days=365)\n    not_after = not_after_date.strftime('%Y%m%d%H%M%SZ').encode('ascii')\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.get_subject().commonName = 'Authority Certificate'\n    cacert.set_issuer(cacert.get_subject())\n    cacert.set_pubkey(cakey)\n    cacert.set_notBefore(b'20000101000000Z')\n    cacert.set_notAfter(not_after)\n    cacert.add_extensions([caext])\n    cacert.set_serial_number(0)\n    cacert.sign(cakey, 'sha256')\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.get_subject().commonName = 'Intermediate Certificate'\n    icert.set_issuer(cacert.get_subject())\n    icert.set_pubkey(ikey)\n    icert.set_notBefore(b'20000101000000Z')\n    icert.set_notAfter(not_after)\n    icert.add_extensions([caext])\n    icert.set_serial_number(0)\n    icert.sign(cakey, 'sha256')\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.get_subject().commonName = 'Server Certificate'\n    scert.set_issuer(icert.get_subject())\n    scert.set_pubkey(skey)\n    scert.set_notBefore(b'20000101000000Z')\n    scert.set_notAfter(not_after)\n    scert.add_extensions([X509Extension(b'basicConstraints', True,\n        b'CA:false')])\n    scert.set_serial_number(0)\n    scert.sign(ikey, 'sha256')\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]\nclass TestConnection():\n    def test_get_peer_cert_chain(self):\n        \"\"\"\n            `Connection.get_peer_cert_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.set_verify(VERIFY_NONE, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_peer_cert_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_peer_cert_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\ndef _create_certificate_chain():\n    \"\"\"\n    Construct and return a chain of certificates.\n        1. A new self-signed certificate authority certificate (cacert)\n        2. A new intermediate certificate signed by cacert (icert)\n        3. A new server certificate signed by icert (scert)\n    \"\"\"\n    caext = X509Extension(b'basicConstraints', False, b'CA:true')\n    not_after_date = datetime.date.today() + datetime.timedelta(days=365)\n    not_after = not_after_date.strftime('%Y%m%d%H%M%SZ').encode('ascii')\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.get_subject().commonName = 'Authority Certificate'\n    cacert.set_issuer(cacert.get_subject())\n    cacert.set_pubkey(cakey)\n    cacert.set_notBefore(b'20000101000000Z')\n    cacert.set_notAfter(not_after)\n    cacert.add_extensions([caext])\n    cacert.set_serial_number(0)\n    cacert.sign(cakey, 'sha256')\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.get_subject().commonName = 'Intermediate Certificate'\n    icert.set_issuer(cacert.get_subject())\n    icert.set_pubkey(ikey)\n    icert.set_notBefore(b'20000101000000Z')\n    icert.set_notAfter(not_after)\n    icert.add_extensions([caext])\n    icert.set_serial_number(0)\n    icert.sign(cakey, 'sha256')\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.get_subject().commonName = 'Server Certificate'\n    scert.set_issuer(icert.get_subject())\n    scert.set_pubkey(skey)\n    scert.set_notBefore(b'20000101000000Z')\n    scert.set_notAfter(not_after)\n    scert.add_extensions([X509Extension(b'basicConstraints', True,\n        b'CA:false')])\n    scert.set_serial_number(0)\n    scert.sign(ikey, 'sha256')\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]\nclass TestConnection():\n    def test_get_verified_chain(self):\n        \"\"\"\n            `Connection.get_verified_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.get_cert_store().add_cert(cacert)\n        clientContext.set_verify(VERIFY_PEER, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_verified_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_verified_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef interact_in_memory(client_conn, server_conn): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "interact_in_memory", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef interact_in_memory(client_conn, server_conn):\n    while True:\n        # Read from client connection\n        client_data = client_conn.recv(4096)\n        if client_data:\n            server_conn.send(client_data)\n            return client_conn, client_data\n        \n        # Read from server connection\n        server_data = server_conn.recv(4096)\n        if server_data:\n            client_conn.send(server_data)\n            return server_conn, server_data\n        \n        # If no data was read from either connection, break the loop\n        if not client_data and not server_data:\n            break\n\n    return None", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\ndef _create_certificate_chain():\n    \"\"\"\n    Construct and return a chain of certificates.\n        1. A new self-signed certificate authority certificate (cacert)\n        2. A new intermediate certificate signed by cacert (icert)\n        3. A new server certificate signed by icert (scert)\n    \"\"\"\n    caext = X509Extension(b'basicConstraints', False, b'CA:true')\n    not_after_date = datetime.date.today() + datetime.timedelta(days=365)\n    not_after = not_after_date.strftime('%Y%m%d%H%M%SZ').encode('ascii')\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.get_subject().commonName = 'Authority Certificate'\n    cacert.set_issuer(cacert.get_subject())\n    cacert.set_pubkey(cakey)\n    cacert.set_notBefore(b'20000101000000Z')\n    cacert.set_notAfter(not_after)\n    cacert.add_extensions([caext])\n    cacert.set_serial_number(0)\n    cacert.sign(cakey, 'sha256')\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.get_subject().commonName = 'Intermediate Certificate'\n    icert.set_issuer(cacert.get_subject())\n    icert.set_pubkey(ikey)\n    icert.set_notBefore(b'20000101000000Z')\n    icert.set_notAfter(not_after)\n    icert.add_extensions([caext])\n    icert.set_serial_number(0)\n    icert.sign(cakey, 'sha256')\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.get_subject().commonName = 'Server Certificate'\n    scert.set_issuer(icert.get_subject())\n    scert.set_pubkey(skey)\n    scert.set_notBefore(b'20000101000000Z')\n    scert.set_notAfter(not_after)\n    scert.add_extensions([X509Extension(b'basicConstraints', True,\n        b'CA:false')])\n    scert.set_serial_number(0)\n    scert.sign(ikey, 'sha256')\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]\nclass TestConnection():\n    def test_get_peer_cert_chain(self):\n        \"\"\"\n            `Connection.get_peer_cert_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.set_verify(VERIFY_NONE, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_peer_cert_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_peer_cert_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\ndef _create_certificate_chain():\n    \"\"\"\n    Construct and return a chain of certificates.\n        1. A new self-signed certificate authority certificate (cacert)\n        2. A new intermediate certificate signed by cacert (icert)\n        3. A new server certificate signed by icert (scert)\n    \"\"\"\n    caext = X509Extension(b'basicConstraints', False, b'CA:true')\n    not_after_date = datetime.date.today() + datetime.timedelta(days=365)\n    not_after = not_after_date.strftime('%Y%m%d%H%M%SZ').encode('ascii')\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.get_subject().commonName = 'Authority Certificate'\n    cacert.set_issuer(cacert.get_subject())\n    cacert.set_pubkey(cakey)\n    cacert.set_notBefore(b'20000101000000Z')\n    cacert.set_notAfter(not_after)\n    cacert.add_extensions([caext])\n    cacert.set_serial_number(0)\n    cacert.sign(cakey, 'sha256')\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.get_subject().commonName = 'Intermediate Certificate'\n    icert.set_issuer(cacert.get_subject())\n    icert.set_pubkey(ikey)\n    icert.set_notBefore(b'20000101000000Z')\n    icert.set_notAfter(not_after)\n    icert.add_extensions([caext])\n    icert.set_serial_number(0)\n    icert.sign(cakey, 'sha256')\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.get_subject().commonName = 'Server Certificate'\n    scert.set_issuer(icert.get_subject())\n    scert.set_pubkey(skey)\n    scert.set_notBefore(b'20000101000000Z')\n    scert.set_notAfter(not_after)\n    scert.add_extensions([X509Extension(b'basicConstraints', True,\n        b'CA:false')])\n    scert.set_serial_number(0)\n    scert.sign(ikey, 'sha256')\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]\nclass TestConnection():\n    def test_get_verified_chain(self):\n        \"\"\"\n            `Connection.get_verified_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.get_cert_store().add_cert(cacert)\n        clientContext.set_verify(VERIFY_PEER, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_verified_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_verified_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef interact_in_memory(client_conn, server_conn): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "interact_in_memory", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef interact_in_memory(client_conn, server_conn):\n    while True:\n        # Read from client\n        try:\n            client_data = client_conn.recv(4096)\n            if client_data:\n                server_conn.send(client_data)\n                return (client_conn, client_data)\n        except WantReadError:\n            pass\n        except WantWriteError:\n            pass\n\n        # Read from server\n        try:\n            server_data = server_conn.recv(4096)\n            if server_data:\n                client_conn.send(server_data)\n                return (server_conn, server_data)\n        except WantReadError:\n            pass\n        except WantWriteError:\n            pass\n\n        # If no data was read from either connection, break the loop\n        if not client_data and not server_data:\n            break\n\n    return None", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\ndef _create_certificate_chain():\n    \"\"\"\n    Construct and return a chain of certificates.\n        1. A new self-signed certificate authority certificate (cacert)\n        2. A new intermediate certificate signed by cacert (icert)\n        3. A new server certificate signed by icert (scert)\n    \"\"\"\n    caext = X509Extension(b'basicConstraints', False, b'CA:true')\n    not_after_date = datetime.date.today() + datetime.timedelta(days=365)\n    not_after = not_after_date.strftime('%Y%m%d%H%M%SZ').encode('ascii')\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.get_subject().commonName = 'Authority Certificate'\n    cacert.set_issuer(cacert.get_subject())\n    cacert.set_pubkey(cakey)\n    cacert.set_notBefore(b'20000101000000Z')\n    cacert.set_notAfter(not_after)\n    cacert.add_extensions([caext])\n    cacert.set_serial_number(0)\n    cacert.sign(cakey, 'sha256')\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.get_subject().commonName = 'Intermediate Certificate'\n    icert.set_issuer(cacert.get_subject())\n    icert.set_pubkey(ikey)\n    icert.set_notBefore(b'20000101000000Z')\n    icert.set_notAfter(not_after)\n    icert.add_extensions([caext])\n    icert.set_serial_number(0)\n    icert.sign(cakey, 'sha256')\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.get_subject().commonName = 'Server Certificate'\n    scert.set_issuer(icert.get_subject())\n    scert.set_pubkey(skey)\n    scert.set_notBefore(b'20000101000000Z')\n    scert.set_notAfter(not_after)\n    scert.add_extensions([X509Extension(b'basicConstraints', True,\n        b'CA:false')])\n    scert.set_serial_number(0)\n    scert.sign(ikey, 'sha256')\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]\nclass TestConnection():\n    def test_get_peer_cert_chain(self):\n        \"\"\"\n            `Connection.get_peer_cert_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.set_verify(VERIFY_NONE, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_peer_cert_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_peer_cert_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\ndef _create_certificate_chain():\n    \"\"\"\n    Construct and return a chain of certificates.\n        1. A new self-signed certificate authority certificate (cacert)\n        2. A new intermediate certificate signed by cacert (icert)\n        3. A new server certificate signed by icert (scert)\n    \"\"\"\n    caext = X509Extension(b'basicConstraints', False, b'CA:true')\n    not_after_date = datetime.date.today() + datetime.timedelta(days=365)\n    not_after = not_after_date.strftime('%Y%m%d%H%M%SZ').encode('ascii')\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.get_subject().commonName = 'Authority Certificate'\n    cacert.set_issuer(cacert.get_subject())\n    cacert.set_pubkey(cakey)\n    cacert.set_notBefore(b'20000101000000Z')\n    cacert.set_notAfter(not_after)\n    cacert.add_extensions([caext])\n    cacert.set_serial_number(0)\n    cacert.sign(cakey, 'sha256')\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.get_subject().commonName = 'Intermediate Certificate'\n    icert.set_issuer(cacert.get_subject())\n    icert.set_pubkey(ikey)\n    icert.set_notBefore(b'20000101000000Z')\n    icert.set_notAfter(not_after)\n    icert.add_extensions([caext])\n    icert.set_serial_number(0)\n    icert.sign(cakey, 'sha256')\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.get_subject().commonName = 'Server Certificate'\n    scert.set_issuer(icert.get_subject())\n    scert.set_pubkey(skey)\n    scert.set_notBefore(b'20000101000000Z')\n    scert.set_notAfter(not_after)\n    scert.add_extensions([X509Extension(b'basicConstraints', True,\n        b'CA:false')])\n    scert.set_serial_number(0)\n    scert.sign(ikey, 'sha256')\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]\nclass TestConnection():\n    def test_get_verified_chain(self):\n        \"\"\"\n            `Connection.get_verified_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.get_cert_store().add_cert(cacert)\n        clientContext.set_verify(VERIFY_PEER, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_verified_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_verified_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef interact_in_memory(client_conn, server_conn): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "interact_in_memory", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef interact_in_memory(client_conn, server_conn):\n    while True:\n        # Read from client connection\n        try:\n            client_data = client_conn.recv(4096)\n        except WantReadError:\n            client_data = b''\n        except Exception as e:\n            return None\n        \n        # Read from server connection\n        try:\n            server_data = server_conn.recv(4096)\n        except WantReadError:\n            server_data = b''\n        except Exception as e:\n            return None\n        \n        # If we received data from the client, send it to the server\n        if client_data:\n            server_conn.send(client_data)\n            return (client_conn, client_data)\n        \n        # If we received data from the server, send it to the client\n        if server_data:\n            client_conn.send(server_data)\n            return (server_conn, server_data)\n        \n        # If no data was received from either connection, break the loop\n        if not client_data and not server_data:\n            break\n    \n    return None", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\ndef _create_certificate_chain():\n    \"\"\"\n    Construct and return a chain of certificates.\n        1. A new self-signed certificate authority certificate (cacert)\n        2. A new intermediate certificate signed by cacert (icert)\n        3. A new server certificate signed by icert (scert)\n    \"\"\"\n    caext = X509Extension(b'basicConstraints', False, b'CA:true')\n    not_after_date = datetime.date.today() + datetime.timedelta(days=365)\n    not_after = not_after_date.strftime('%Y%m%d%H%M%SZ').encode('ascii')\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.get_subject().commonName = 'Authority Certificate'\n    cacert.set_issuer(cacert.get_subject())\n    cacert.set_pubkey(cakey)\n    cacert.set_notBefore(b'20000101000000Z')\n    cacert.set_notAfter(not_after)\n    cacert.add_extensions([caext])\n    cacert.set_serial_number(0)\n    cacert.sign(cakey, 'sha256')\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.get_subject().commonName = 'Intermediate Certificate'\n    icert.set_issuer(cacert.get_subject())\n    icert.set_pubkey(ikey)\n    icert.set_notBefore(b'20000101000000Z')\n    icert.set_notAfter(not_after)\n    icert.add_extensions([caext])\n    icert.set_serial_number(0)\n    icert.sign(cakey, 'sha256')\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.get_subject().commonName = 'Server Certificate'\n    scert.set_issuer(icert.get_subject())\n    scert.set_pubkey(skey)\n    scert.set_notBefore(b'20000101000000Z')\n    scert.set_notAfter(not_after)\n    scert.add_extensions([X509Extension(b'basicConstraints', True,\n        b'CA:false')])\n    scert.set_serial_number(0)\n    scert.sign(ikey, 'sha256')\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]\nclass TestConnection():\n    def test_get_peer_cert_chain(self):\n        \"\"\"\n            `Connection.get_peer_cert_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.set_verify(VERIFY_NONE, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_peer_cert_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_peer_cert_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\ndef _create_certificate_chain():\n    \"\"\"\n    Construct and return a chain of certificates.\n        1. A new self-signed certificate authority certificate (cacert)\n        2. A new intermediate certificate signed by cacert (icert)\n        3. A new server certificate signed by icert (scert)\n    \"\"\"\n    caext = X509Extension(b'basicConstraints', False, b'CA:true')\n    not_after_date = datetime.date.today() + datetime.timedelta(days=365)\n    not_after = not_after_date.strftime('%Y%m%d%H%M%SZ').encode('ascii')\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.get_subject().commonName = 'Authority Certificate'\n    cacert.set_issuer(cacert.get_subject())\n    cacert.set_pubkey(cakey)\n    cacert.set_notBefore(b'20000101000000Z')\n    cacert.set_notAfter(not_after)\n    cacert.add_extensions([caext])\n    cacert.set_serial_number(0)\n    cacert.sign(cakey, 'sha256')\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.get_subject().commonName = 'Intermediate Certificate'\n    icert.set_issuer(cacert.get_subject())\n    icert.set_pubkey(ikey)\n    icert.set_notBefore(b'20000101000000Z')\n    icert.set_notAfter(not_after)\n    icert.add_extensions([caext])\n    icert.set_serial_number(0)\n    icert.sign(cakey, 'sha256')\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.get_subject().commonName = 'Server Certificate'\n    scert.set_issuer(icert.get_subject())\n    scert.set_pubkey(skey)\n    scert.set_notBefore(b'20000101000000Z')\n    scert.set_notAfter(not_after)\n    scert.add_extensions([X509Extension(b'basicConstraints', True,\n        b'CA:false')])\n    scert.set_serial_number(0)\n    scert.sign(ikey, 'sha256')\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]\nclass TestConnection():\n    def test_get_verified_chain(self):\n        \"\"\"\n            `Connection.get_verified_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.get_cert_store().add_cert(cacert)\n        clientContext.set_verify(VERIFY_PEER, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_verified_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_verified_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef interact_in_memory(client_conn, server_conn): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "interact_in_memory", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef interact_in_memory(client_conn, server_conn):\n    while True:\n        # Read from client connection\n        try:\n            client_data = client_conn.recv(4096)\n        except WantReadError:\n            client_data = b''\n        except WantWriteError:\n            client_data = b''\n        except Exception as e:\n            break\n\n        if client_data:\n            server_conn.send(client_data)\n            return client_conn, client_data\n\n        # Read from server connection\n        try:\n            server_data = server_conn.recv(4096)\n        except WantReadError:\n            server_data = b''\n        except WantWriteError:\n            server_data = b''\n        except Exception as e:\n            break\n\n        if server_data:\n            client_conn.send(server_data)\n            return server_conn, server_data\n\n        # If no data was received from either connection, break the loop\n        if not client_data and not server_data:\n            break\n\n    return None", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\ndef _create_certificate_chain():\n    \"\"\"\n    Construct and return a chain of certificates.\n        1. A new self-signed certificate authority certificate (cacert)\n        2. A new intermediate certificate signed by cacert (icert)\n        3. A new server certificate signed by icert (scert)\n    \"\"\"\n    caext = X509Extension(b'basicConstraints', False, b'CA:true')\n    not_after_date = datetime.date.today() + datetime.timedelta(days=365)\n    not_after = not_after_date.strftime('%Y%m%d%H%M%SZ').encode('ascii')\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.get_subject().commonName = 'Authority Certificate'\n    cacert.set_issuer(cacert.get_subject())\n    cacert.set_pubkey(cakey)\n    cacert.set_notBefore(b'20000101000000Z')\n    cacert.set_notAfter(not_after)\n    cacert.add_extensions([caext])\n    cacert.set_serial_number(0)\n    cacert.sign(cakey, 'sha256')\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.get_subject().commonName = 'Intermediate Certificate'\n    icert.set_issuer(cacert.get_subject())\n    icert.set_pubkey(ikey)\n    icert.set_notBefore(b'20000101000000Z')\n    icert.set_notAfter(not_after)\n    icert.add_extensions([caext])\n    icert.set_serial_number(0)\n    icert.sign(cakey, 'sha256')\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.get_subject().commonName = 'Server Certificate'\n    scert.set_issuer(icert.get_subject())\n    scert.set_pubkey(skey)\n    scert.set_notBefore(b'20000101000000Z')\n    scert.set_notAfter(not_after)\n    scert.add_extensions([X509Extension(b'basicConstraints', True,\n        b'CA:false')])\n    scert.set_serial_number(0)\n    scert.sign(ikey, 'sha256')\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]\nclass TestConnection():\n    def test_get_peer_cert_chain(self):\n        \"\"\"\n            `Connection.get_peer_cert_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.set_verify(VERIFY_NONE, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_peer_cert_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_peer_cert_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\ndef _create_certificate_chain():\n    \"\"\"\n    Construct and return a chain of certificates.\n        1. A new self-signed certificate authority certificate (cacert)\n        2. A new intermediate certificate signed by cacert (icert)\n        3. A new server certificate signed by icert (scert)\n    \"\"\"\n    caext = X509Extension(b'basicConstraints', False, b'CA:true')\n    not_after_date = datetime.date.today() + datetime.timedelta(days=365)\n    not_after = not_after_date.strftime('%Y%m%d%H%M%SZ').encode('ascii')\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.get_subject().commonName = 'Authority Certificate'\n    cacert.set_issuer(cacert.get_subject())\n    cacert.set_pubkey(cakey)\n    cacert.set_notBefore(b'20000101000000Z')\n    cacert.set_notAfter(not_after)\n    cacert.add_extensions([caext])\n    cacert.set_serial_number(0)\n    cacert.sign(cakey, 'sha256')\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.get_subject().commonName = 'Intermediate Certificate'\n    icert.set_issuer(cacert.get_subject())\n    icert.set_pubkey(ikey)\n    icert.set_notBefore(b'20000101000000Z')\n    icert.set_notAfter(not_after)\n    icert.add_extensions([caext])\n    icert.set_serial_number(0)\n    icert.sign(cakey, 'sha256')\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.get_subject().commonName = 'Server Certificate'\n    scert.set_issuer(icert.get_subject())\n    scert.set_pubkey(skey)\n    scert.set_notBefore(b'20000101000000Z')\n    scert.set_notAfter(not_after)\n    scert.add_extensions([X509Extension(b'basicConstraints', True,\n        b'CA:false')])\n    scert.set_serial_number(0)\n    scert.sign(ikey, 'sha256')\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]\nclass TestConnection():\n    def test_get_verified_chain(self):\n        \"\"\"\n            `Connection.get_verified_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.get_cert_store().add_cert(cacert)\n        clientContext.set_verify(VERIFY_PEER, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_verified_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_verified_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef interact_in_memory(client_conn, server_conn): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "_create_certificate_chain", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef _create_certificate_chain():\n    # Generate CA key and certificate\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.set_serial_number(1)\n    cacert.gmtime_adj_notBefore(0)\n    cacert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # Valid for 10 years\n    cacert.set_pubkey(cakey)\n    cacert.get_subject().CN = \"My Certificate Authority\"\n    cacert.set_issuer(cacert.get_subject())  # Self-signed\n    cacert.sign(cakey, 'sha256')\n\n    # Generate Intermediate key and certificate\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.set_serial_number(2)\n    icert.gmtime_adj_notBefore(0)\n    icert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # Valid for 10 years\n    icert.set_pubkey(ikey)\n    icert.get_subject().CN = \"My Intermediate Certificate\"\n    icert.set_issuer(cacert.get_subject())  # Signed by CA\n    icert.sign(cakey, 'sha256')\n\n    # Generate Server key and certificate\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.set_serial_number(3)\n    scert.gmtime_adj_notBefore(0)\n    scert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # Valid for 10 years\n    scert.set_pubkey(skey)\n    scert.get_subject().CN = \"My Server Certificate\"\n    scert.set_issuer(icert.get_subject())  # Signed by Intermediate\n    scert.sign(ikey, 'sha256')\n\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_get_certificate(self):\n        \"\"\"\n            `Connection.get_certificate` returns the local certificate.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        context = Context(SSLv23_METHOD)\n        context.use_certificate(scert)\n        client = Connection(context, None)\n        cert = client.get_certificate()\n        assert cert is not None\n        assert 'Server Certificate' == cert.get_subject().CN\n    \nTestConnection().test_get_certificate()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef interact_in_memory(client_conn, server_conn):\n    \"\"\"\n    Try to read application bytes from each of the two `Connection` objects.\n    Copy bytes back and forth between their send/receive buffers for as long\n    as there is anything to copy.  When there is nothing more to copy,\n    return `None`.  If one of them actually manages to deliver some application\n    bytes, return a two-tuple of the connection from which the bytes were read\n    and the bytes themselves.\n    \"\"\"\n    wrote = True\n    while wrote:\n        wrote = False\n        for read, write in [(client_conn, server_conn), (server_conn,\n            client_conn)]:\n            try:\n                data = read.recv(2 ** 16)\n            except WantReadError:\n                pass\n            else:\n                return read, data\n            while True:\n                try:\n                    dirty = read.bio_read(4096)\n                except WantReadError:\n                    break\n                else:\n                    wrote = True\n                    write.bio_write(dirty)\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\nclass TestConnection():\n    def test_get_peer_cert_chain(self):\n        \"\"\"\n            `Connection.get_peer_cert_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.set_verify(VERIFY_NONE, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_peer_cert_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_peer_cert_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef interact_in_memory(client_conn, server_conn):\n    \"\"\"\n    Try to read application bytes from each of the two `Connection` objects.\n    Copy bytes back and forth between their send/receive buffers for as long\n    as there is anything to copy.  When there is nothing more to copy,\n    return `None`.  If one of them actually manages to deliver some application\n    bytes, return a two-tuple of the connection from which the bytes were read\n    and the bytes themselves.\n    \"\"\"\n    wrote = True\n    while wrote:\n        wrote = False\n        for read, write in [(client_conn, server_conn), (server_conn,\n            client_conn)]:\n            try:\n                data = read.recv(2 ** 16)\n            except WantReadError:\n                pass\n            else:\n                return read, data\n            while True:\n                try:\n                    dirty = read.bio_read(4096)\n                except WantReadError:\n                    break\n                else:\n                    wrote = True\n                    write.bio_write(dirty)\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\nclass TestConnection():\n    def test_get_verified_chain(self):\n        \"\"\"\n            `Connection.get_verified_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.get_cert_store().add_cert(cacert)\n        clientContext.set_verify(VERIFY_PEER, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_verified_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_verified_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef _create_certificate_chain(): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "_create_certificate_chain", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef _create_certificate_chain():\n    # Generate CA key and certificate\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_serial_number(1)\n    cacert.gmtime_adj_notBefore(0)\n    cacert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # Valid for 10 years\n    cacert.set_pubkey(cakey)\n    cacert.set_subject_name(x509.Name([\n        x509.NameAttribute(NameOID.COUNTRY_NAME, u\"US\"),\n        x509.NameAttribute(NameOID.STATE_OR_PROVINCE_NAME, u\"California\"),\n        x509.NameAttribute(NameOID.LOCALITY_NAME, u\"San Francisco\"),\n        x509.NameAttribute(NameOID.ORGANIZATION_NAME, u\"My Company\"),\n        x509.NameAttribute(NameOID.COMMON_NAME, u\"My CA\"),\n    ]))\n    cacert.set_issuer(cacert.get_subject())\n    cacert.add_extensions([\n        X509Extension(b\"basicConstraints\", True, b\"CA:TRUE, pathlen:0\"),\n    ])\n    cacert.sign(cakey, 'sha256')\n\n    # Generate intermediate key and certificate\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_serial_number(2)\n    icert.gmtime_adj_notBefore(0)\n    icert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # Valid for 10 years\n    icert.set_pubkey(ikey)\n    icert.set_subject_name(x509.Name([\n        x509.NameAttribute(NameOID.COUNTRY_NAME, u\"US\"),\n        x509.NameAttribute(NameOID.STATE_OR_PROVINCE_NAME, u\"California\"),\n        x509.NameAttribute(NameOID.LOCALITY_NAME, u\"San Francisco\"),\n        x509.NameAttribute(NameOID.ORGANIZATION_NAME, u\"My Company\"),\n        x509.NameAttribute(NameOID.COMMON_NAME, u\"My Intermediate CA\"),\n    ]))\n    icert.set_issuer(cacert.get_subject())\n    icert.add_extensions([\n        X509Extension(b\"basicConstraints\", True, b\"CA:FALSE\"),\n    ])\n    icert.sign(cakey, 'sha256')\n\n    # Generate server key and certificate\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_serial_number(3)\n    scert.gmtime_adj_notBefore(0)\n    scert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # Valid for 10 years\n    scert.set_pubkey(skey)\n    scert.set_subject_name(x509.Name([\n        x509.NameAttribute(NameOID.COUNTRY_NAME, u\"US\"),\n        x509.NameAttribute(NameOID.STATE_OR_PROVINCE_NAME, u\"California\"),\n        x509.NameAttribute(NameOID.LOCALITY_NAME, u\"San Francisco\"),\n        x509.NameAttribute(NameOID.ORGANIZATION_NAME, u\"My Company\"),\n        x509.NameAttribute(NameOID.COMMON_NAME, u\"www.myserver.com\"),\n    ]))\n    scert.set_issuer(icert.get_subject())\n    scert.sign(ikey, 'sha256')\n\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_get_certificate(self):\n        \"\"\"\n            `Connection.get_certificate` returns the local certificate.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        context = Context(SSLv23_METHOD)\n        context.use_certificate(scert)\n        client = Connection(context, None)\n        cert = client.get_certificate()\n        assert cert is not None\n        assert 'Server Certificate' == cert.get_subject().CN\n    \nTestConnection().test_get_certificate()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef interact_in_memory(client_conn, server_conn):\n    \"\"\"\n    Try to read application bytes from each of the two `Connection` objects.\n    Copy bytes back and forth between their send/receive buffers for as long\n    as there is anything to copy.  When there is nothing more to copy,\n    return `None`.  If one of them actually manages to deliver some application\n    bytes, return a two-tuple of the connection from which the bytes were read\n    and the bytes themselves.\n    \"\"\"\n    wrote = True\n    while wrote:\n        wrote = False\n        for read, write in [(client_conn, server_conn), (server_conn,\n            client_conn)]:\n            try:\n                data = read.recv(2 ** 16)\n            except WantReadError:\n                pass\n            else:\n                return read, data\n            while True:\n                try:\n                    dirty = read.bio_read(4096)\n                except WantReadError:\n                    break\n                else:\n                    wrote = True\n                    write.bio_write(dirty)\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\nclass TestConnection():\n    def test_get_peer_cert_chain(self):\n        \"\"\"\n            `Connection.get_peer_cert_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.set_verify(VERIFY_NONE, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_peer_cert_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_peer_cert_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef interact_in_memory(client_conn, server_conn):\n    \"\"\"\n    Try to read application bytes from each of the two `Connection` objects.\n    Copy bytes back and forth between their send/receive buffers for as long\n    as there is anything to copy.  When there is nothing more to copy,\n    return `None`.  If one of them actually manages to deliver some application\n    bytes, return a two-tuple of the connection from which the bytes were read\n    and the bytes themselves.\n    \"\"\"\n    wrote = True\n    while wrote:\n        wrote = False\n        for read, write in [(client_conn, server_conn), (server_conn,\n            client_conn)]:\n            try:\n                data = read.recv(2 ** 16)\n            except WantReadError:\n                pass\n            else:\n                return read, data\n            while True:\n                try:\n                    dirty = read.bio_read(4096)\n                except WantReadError:\n                    break\n                else:\n                    wrote = True\n                    write.bio_write(dirty)\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\nclass TestConnection():\n    def test_get_verified_chain(self):\n        \"\"\"\n            `Connection.get_verified_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.get_cert_store().add_cert(cacert)\n        clientContext.set_verify(VERIFY_PEER, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_verified_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_verified_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef _create_certificate_chain(): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "_create_certificate_chain", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef _create_certificate_chain():\n    # Generate CA key and certificate\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_serial_number(1)\n    cacert.gmtime_adj_notBefore(0)\n    cacert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # Valid for 10 years\n    cacert.set_pubkey(cakey)\n    cacert.set_subject_name(x509.Name([\n        x509.NameAttribute(NameOID.COUNTRY_NAME, u\"US\"),\n        x509.NameAttribute(NameOID.STATE_OR_PROVINCE_NAME, u\"California\"),\n        x509.NameAttribute(NameOID.LOCALITY_NAME, u\"San Francisco\"),\n        x509.NameAttribute(NameOID.ORGANIZATION_NAME, u\"My Company\"),\n        x509.NameAttribute(NameOID.COMMON_NAME, u\"My CA\"),\n    ]))\n    cacert.set_issuer(cacert.get_subject())\n    cacert.add_extensions([X509Extension(b\"basicConstraints\", True, b\"CA:TRUE\")])\n    cacert.sign(cakey, 'sha256')\n\n    # Generate Intermediate key and certificate\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_serial_number(2)\n    icert.gmtime_adj_notBefore(0)\n    icert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # Valid for 10 years\n    icert.set_pubkey(ikey)\n    icert.set_subject_name(x509.Name([\n        x509.NameAttribute(NameOID.COUNTRY_NAME, u\"US\"),\n        x509.NameAttribute(NameOID.STATE_OR_PROVINCE_NAME, u\"California\"),\n        x509.NameAttribute(NameOID.LOCALITY_NAME, u\"San Francisco\"),\n        x509.NameAttribute(NameOID.ORGANIZATION_NAME, u\"My Company\"),\n        x509.NameAttribute(NameOID.COMMON_NAME, u\"My Intermediate CA\"),\n    ]))\n    icert.set_issuer(cacert.get_subject())\n    icert.sign(cakey, 'sha256')\n\n    # Generate Server key and certificate\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_serial_number(3)\n    scert.gmtime_adj_notBefore(0)\n    scert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # Valid for 10 years\n    scert.set_pubkey(skey)\n    scert.set_subject_name(x509.Name([\n        x509.NameAttribute(NameOID.COUNTRY_NAME, u\"US\"),\n        x509.NameAttribute(NameOID.STATE_OR_PROVINCE_NAME, u\"California\"),\n        x509.NameAttribute(NameOID.LOCALITY_NAME, u\"San Francisco\"),\n        x509.NameAttribute(NameOID.ORGANIZATION_NAME, u\"My Company\"),\n        x509.NameAttribute(NameOID.COMMON_NAME, u\"myserver.com\"),\n    ]))\n    scert.set_issuer(icert.get_subject())\n    scert.sign(ikey, 'sha256')\n\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_get_certificate(self):\n        \"\"\"\n            `Connection.get_certificate` returns the local certificate.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        context = Context(SSLv23_METHOD)\n        context.use_certificate(scert)\n        client = Connection(context, None)\n        cert = client.get_certificate()\n        assert cert is not None\n        assert 'Server Certificate' == cert.get_subject().CN\n    \nTestConnection().test_get_certificate()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef interact_in_memory(client_conn, server_conn):\n    \"\"\"\n    Try to read application bytes from each of the two `Connection` objects.\n    Copy bytes back and forth between their send/receive buffers for as long\n    as there is anything to copy.  When there is nothing more to copy,\n    return `None`.  If one of them actually manages to deliver some application\n    bytes, return a two-tuple of the connection from which the bytes were read\n    and the bytes themselves.\n    \"\"\"\n    wrote = True\n    while wrote:\n        wrote = False\n        for read, write in [(client_conn, server_conn), (server_conn,\n            client_conn)]:\n            try:\n                data = read.recv(2 ** 16)\n            except WantReadError:\n                pass\n            else:\n                return read, data\n            while True:\n                try:\n                    dirty = read.bio_read(4096)\n                except WantReadError:\n                    break\n                else:\n                    wrote = True\n                    write.bio_write(dirty)\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\nclass TestConnection():\n    def test_get_peer_cert_chain(self):\n        \"\"\"\n            `Connection.get_peer_cert_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.set_verify(VERIFY_NONE, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_peer_cert_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_peer_cert_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef interact_in_memory(client_conn, server_conn):\n    \"\"\"\n    Try to read application bytes from each of the two `Connection` objects.\n    Copy bytes back and forth between their send/receive buffers for as long\n    as there is anything to copy.  When there is nothing more to copy,\n    return `None`.  If one of them actually manages to deliver some application\n    bytes, return a two-tuple of the connection from which the bytes were read\n    and the bytes themselves.\n    \"\"\"\n    wrote = True\n    while wrote:\n        wrote = False\n        for read, write in [(client_conn, server_conn), (server_conn,\n            client_conn)]:\n            try:\n                data = read.recv(2 ** 16)\n            except WantReadError:\n                pass\n            else:\n                return read, data\n            while True:\n                try:\n                    dirty = read.bio_read(4096)\n                except WantReadError:\n                    break\n                else:\n                    wrote = True\n                    write.bio_write(dirty)\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\nclass TestConnection():\n    def test_get_verified_chain(self):\n        \"\"\"\n            `Connection.get_verified_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.get_cert_store().add_cert(cacert)\n        clientContext.set_verify(VERIFY_PEER, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_verified_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_verified_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef _create_certificate_chain(): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "_create_certificate_chain", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef _create_certificate_chain():\n    # Generate CA key and certificate\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.set_serial_number(1)\n    cacert.gmtime_adj_notBefore(0)\n    cacert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # valid for 10 years\n    cacert.set_pubkey(cakey)\n    cacert.get_subject().CN = \"My Certificate Authority\"\n    cacert.set_issuer(cacert.get_subject())\n    cacert.sign(cakey, 'sha256')\n\n    # Generate Intermediate key and certificate\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.set_serial_number(2)\n    icert.gmtime_adj_notBefore(0)\n    icert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # valid for 10 years\n    icert.set_pubkey(ikey)\n    icert.get_subject().CN = \"My Intermediate Certificate\"\n    icert.set_issuer(cacert.get_subject())\n    icert.sign(cakey, 'sha256')\n\n    # Generate Server key and certificate\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.set_serial_number(3)\n    scert.gmtime_adj_notBefore(0)\n    scert.gmtime_adj_notAfter(10 * 365 * 24 * 60 * 60)  # valid for 10 years\n    scert.set_pubkey(skey)\n    scert.get_subject().CN = \"My Server Certificate\"\n    scert.set_issuer(icert.get_subject())\n    scert.sign(ikey, 'sha256')\n\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_get_certificate(self):\n        \"\"\"\n            `Connection.get_certificate` returns the local certificate.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        context = Context(SSLv23_METHOD)\n        context.use_certificate(scert)\n        client = Connection(context, None)\n        cert = client.get_certificate()\n        assert cert is not None\n        assert 'Server Certificate' == cert.get_subject().CN\n    \nTestConnection().test_get_certificate()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef interact_in_memory(client_conn, server_conn):\n    \"\"\"\n    Try to read application bytes from each of the two `Connection` objects.\n    Copy bytes back and forth between their send/receive buffers for as long\n    as there is anything to copy.  When there is nothing more to copy,\n    return `None`.  If one of them actually manages to deliver some application\n    bytes, return a two-tuple of the connection from which the bytes were read\n    and the bytes themselves.\n    \"\"\"\n    wrote = True\n    while wrote:\n        wrote = False\n        for read, write in [(client_conn, server_conn), (server_conn,\n            client_conn)]:\n            try:\n                data = read.recv(2 ** 16)\n            except WantReadError:\n                pass\n            else:\n                return read, data\n            while True:\n                try:\n                    dirty = read.bio_read(4096)\n                except WantReadError:\n                    break\n                else:\n                    wrote = True\n                    write.bio_write(dirty)\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\nclass TestConnection():\n    def test_get_peer_cert_chain(self):\n        \"\"\"\n            `Connection.get_peer_cert_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.set_verify(VERIFY_NONE, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_peer_cert_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_peer_cert_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef interact_in_memory(client_conn, server_conn):\n    \"\"\"\n    Try to read application bytes from each of the two `Connection` objects.\n    Copy bytes back and forth between their send/receive buffers for as long\n    as there is anything to copy.  When there is nothing more to copy,\n    return `None`.  If one of them actually manages to deliver some application\n    bytes, return a two-tuple of the connection from which the bytes were read\n    and the bytes themselves.\n    \"\"\"\n    wrote = True\n    while wrote:\n        wrote = False\n        for read, write in [(client_conn, server_conn), (server_conn,\n            client_conn)]:\n            try:\n                data = read.recv(2 ** 16)\n            except WantReadError:\n                pass\n            else:\n                return read, data\n            while True:\n                try:\n                    dirty = read.bio_read(4096)\n                except WantReadError:\n                    break\n                else:\n                    wrote = True\n                    write.bio_write(dirty)\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\nclass TestConnection():\n    def test_get_verified_chain(self):\n        \"\"\"\n            `Connection.get_verified_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.get_cert_store().add_cert(cacert)\n        clientContext.set_verify(VERIFY_PEER, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_verified_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_verified_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef _create_certificate_chain(): [MASK]\n"}
{"model_name": "gpt-4o-mini", "repository": "pyopenssl", "full_method_name": "_create_certificate_chain", "method_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py", "response": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef _create_certificate_chain():\n    # Generate CA key and certificate\n    cakey = PKey()\n    cakey.generate_key(TYPE_RSA, 2048)\n    cacert = X509()\n    cacert.set_version(2)\n    cacert.set_serial_number(1)\n    cacert.gmtime_adj_notBefore(0)\n    cacert.gmtime_adj_notAfter(10 * 365 * 24 * 3600)  # Valid for 10 years\n    cacert.set_pubkey(cakey)\n    cacert.get_subject().CN = \"My Certificate Authority\"\n    cacert.set_issuer(cacert.get_subject())  # Self-signed\n    cacert.sign(cakey, 'sha256')\n\n    # Generate Intermediate key and certificate\n    ikey = PKey()\n    ikey.generate_key(TYPE_RSA, 2048)\n    icert = X509()\n    icert.set_version(2)\n    icert.set_serial_number(2)\n    icert.gmtime_adj_notBefore(0)\n    icert.gmtime_adj_notAfter(10 * 365 * 24 * 3600)  # Valid for 10 years\n    icert.set_pubkey(ikey)\n    icert.get_subject().CN = \"My Intermediate Certificate\"\n    icert.set_issuer(cacert.get_subject())  # Signed by CA\n    icert.sign(cakey, 'sha256')\n\n    # Generate Server key and certificate\n    skey = PKey()\n    skey.generate_key(TYPE_RSA, 2048)\n    scert = X509()\n    scert.set_version(2)\n    scert.set_serial_number(3)\n    scert.gmtime_adj_notBefore(0)\n    scert.gmtime_adj_notAfter(10 * 365 * 24 * 3600)  # Valid for 10 years\n    scert.set_pubkey(skey)\n    scert.get_subject().CN = \"My Server Certificate\"\n    scert.set_issuer(icert.get_subject())  # Signed by Intermediate\n    scert.sign(ikey, 'sha256')\n\n    return [(cakey, cacert), (ikey, icert), (skey, scert)]", "test_code_list": [{"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\nclass TestConnection():\n    def test_get_certificate(self):\n        \"\"\"\n            `Connection.get_certificate` returns the local certificate.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        context = Context(SSLv23_METHOD)\n        context.use_certificate(scert)\n        client = Connection(context, None)\n        cert = client.get_certificate()\n        assert cert is not None\n        assert 'Server Certificate' == cert.get_subject().CN\n    \nTestConnection().test_get_certificate()\n", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef interact_in_memory(client_conn, server_conn):\n    \"\"\"\n    Try to read application bytes from each of the two `Connection` objects.\n    Copy bytes back and forth between their send/receive buffers for as long\n    as there is anything to copy.  When there is nothing more to copy,\n    return `None`.  If one of them actually manages to deliver some application\n    bytes, return a two-tuple of the connection from which the bytes were read\n    and the bytes themselves.\n    \"\"\"\n    wrote = True\n    while wrote:\n        wrote = False\n        for read, write in [(client_conn, server_conn), (server_conn,\n            client_conn)]:\n            try:\n                data = read.recv(2 ** 16)\n            except WantReadError:\n                pass\n            else:\n                return read, data\n            while True:\n                try:\n                    dirty = read.bio_read(4096)\n                except WantReadError:\n                    break\n                else:\n                    wrote = True\n                    write.bio_write(dirty)\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\nclass TestConnection():\n    def test_get_peer_cert_chain(self):\n        \"\"\"\n            `Connection.get_peer_cert_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.set_verify(VERIFY_NONE, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_peer_cert_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_peer_cert_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}, {"test_code": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\ndef interact_in_memory(client_conn, server_conn):\n    \"\"\"\n    Try to read application bytes from each of the two `Connection` objects.\n    Copy bytes back and forth between their send/receive buffers for as long\n    as there is anything to copy.  When there is nothing more to copy,\n    return `None`.  If one of them actually manages to deliver some application\n    bytes, return a two-tuple of the connection from which the bytes were read\n    and the bytes themselves.\n    \"\"\"\n    wrote = True\n    while wrote:\n        wrote = False\n        for read, write in [(client_conn, server_conn), (server_conn,\n            client_conn)]:\n            try:\n                data = read.recv(2 ** 16)\n            except WantReadError:\n                pass\n            else:\n                return read, data\n            while True:\n                try:\n                    dirty = read.bio_read(4096)\n                except WantReadError:\n                    break\n                else:\n                    wrote = True\n                    write.bio_write(dirty)\ndef verify_cb(conn, cert, errnum, depth, ok):\n    return ok\nclass TestConnection():\n    def test_get_verified_chain(self):\n        \"\"\"\n            `Connection.get_verified_chain` returns a list of certificates\n            which the connected server returned for the certification verification.\n            \"\"\"\n        chain = _create_certificate_chain()\n        [(cakey, cacert), (ikey, icert), (skey, scert)] = chain\n        serverContext = Context(SSLv23_METHOD)\n        serverContext.use_privatekey(skey)\n        serverContext.use_certificate(scert)\n        serverContext.add_extra_chain_cert(icert)\n        serverContext.add_extra_chain_cert(cacert)\n        server = Connection(serverContext, None)\n        server.set_accept_state()\n        clientContext = Context(SSLv23_METHOD)\n        clientContext.get_cert_store().add_cert(cacert)\n        clientContext.set_verify(VERIFY_PEER, verify_cb)\n        client = Connection(clientContext, None)\n        client.set_connect_state()\n        interact_in_memory(client, server)\n        chain = client.get_verified_chain()\n        assert len(chain) == 3\n        assert 'Server Certificate' == chain[0].get_subject().CN\n        assert 'Intermediate Certificate' == chain[1].get_subject().CN\n        assert 'Authority Certificate' == chain[2].get_subject().CN\nTestConnection().test_get_verified_chain()", "code_start": "", "test_path": "/home/zhuqiming2022/workspace/doceb/../srcdata/Cryptography/pyopenssl/tests/test_ssl.py"}], "method_code_mask": "import datetime\nimport gc\nimport select\nimport sys\nimport time\nimport uuid\nfrom errno import EAFNOSUPPORT\nfrom errno import ECONNREFUSED\nfrom errno import EINPROGRESS\nfrom errno import EPIPE\nfrom errno import ESHUTDOWN\nfrom errno import EWOULDBLOCK\nfrom gc import collect\nfrom gc import get_referrers\nfrom os import makedirs\nfrom os.path import join\nfrom socket import AF_INET\nfrom socket import AF_INET6\nfrom socket import MSG_PEEK\nfrom socket import SHUT_RDWR\nfrom socket import gaierror\nfrom socket import socket\nfrom sys import getfilesystemencoding\nfrom sys import platform\nfrom typing import Union\nfrom weakref import ref\nimport pytest\nfrom cryptography import x509\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.x509.oid import NameOID\nfrom OpenSSL import SSL\nfrom OpenSSL._util import ffi as _ffi\nfrom OpenSSL._util import lib as _lib\nfrom OpenSSL.crypto import FILETYPE_PEM\nfrom OpenSSL.crypto import TYPE_RSA\nfrom OpenSSL.crypto import X509\nfrom OpenSSL.crypto import PKey\nfrom OpenSSL.crypto import X509Store\nfrom OpenSSL.crypto import dump_certificate\nfrom OpenSSL.crypto import dump_privatekey\nfrom OpenSSL.crypto import get_elliptic_curves\nfrom OpenSSL.crypto import load_certificate\nfrom OpenSSL.crypto import load_privatekey\nfrom OpenSSL.crypto import X509Extension\nfrom OpenSSL.SSL import DTLS_METHOD\nfrom OpenSSL.SSL import MODE_RELEASE_BUFFERS\nfrom OpenSSL.SSL import NO_OVERLAPPING_PROTOCOLS\nfrom OpenSSL.SSL import OP_COOKIE_EXCHANGE\nfrom OpenSSL.SSL import OP_NO_COMPRESSION\nfrom OpenSSL.SSL import OP_NO_QUERY_MTU\nfrom OpenSSL.SSL import OP_NO_TICKET\nfrom OpenSSL.SSL import OP_SINGLE_DH_USE\nfrom OpenSSL.SSL import OPENSSL_VERSION_NUMBER\nfrom OpenSSL.SSL import RECEIVED_SHUTDOWN\nfrom OpenSSL.SSL import SENT_SHUTDOWN\nfrom OpenSSL.SSL import SESS_CACHE_BOTH\nfrom OpenSSL.SSL import SESS_CACHE_CLIENT\nfrom OpenSSL.SSL import SESS_CACHE_NO_AUTO_CLEAR\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_LOOKUP\nfrom OpenSSL.SSL import SESS_CACHE_NO_INTERNAL_STORE\nfrom OpenSSL.SSL import SESS_CACHE_OFF\nfrom OpenSSL.SSL import SESS_CACHE_SERVER\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_EXIT\nfrom OpenSSL.SSL import SSL_CB_ACCEPT_LOOP\nfrom OpenSSL.SSL import SSL_CB_ALERT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_EXIT\nfrom OpenSSL.SSL import SSL_CB_CONNECT_LOOP\nfrom OpenSSL.SSL import SSL_CB_EXIT\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_DONE\nfrom OpenSSL.SSL import SSL_CB_HANDSHAKE_START\nfrom OpenSSL.SSL import SSL_CB_LOOP\nfrom OpenSSL.SSL import SSL_CB_READ\nfrom OpenSSL.SSL import SSL_CB_READ_ALERT\nfrom OpenSSL.SSL import SSL_CB_WRITE\nfrom OpenSSL.SSL import SSL_CB_WRITE_ALERT\nfrom OpenSSL.SSL import SSL_ST_ACCEPT\nfrom OpenSSL.SSL import SSL_ST_CONNECT\nfrom OpenSSL.SSL import SSL_ST_MASK\nfrom OpenSSL.SSL import SSLEAY_BUILT_ON\nfrom OpenSSL.SSL import SSLEAY_CFLAGS\nfrom OpenSSL.SSL import SSLEAY_DIR\nfrom OpenSSL.SSL import SSLEAY_PLATFORM\nfrom OpenSSL.SSL import SSLEAY_VERSION\nfrom OpenSSL.SSL import TLS1_1_VERSION\nfrom OpenSSL.SSL import TLS1_2_VERSION\nfrom OpenSSL.SSL import TLS1_3_VERSION\nfrom OpenSSL.SSL import TLS_METHOD\nfrom OpenSSL.SSL import VERIFY_CLIENT_ONCE\nfrom OpenSSL.SSL import VERIFY_FAIL_IF_NO_PEER_CERT\nfrom OpenSSL.SSL import VERIFY_NONE\nfrom OpenSSL.SSL import VERIFY_PEER\nfrom OpenSSL.SSL import Connection\nfrom OpenSSL.SSL import Context\nfrom OpenSSL.SSL import Error\nfrom OpenSSL.SSL import OP_NO_SSLv2\nfrom OpenSSL.SSL import OP_NO_SSLv3\nfrom OpenSSL.SSL import Session\nfrom OpenSSL.SSL import SSLeay_version\nfrom OpenSSL.SSL import SSLv23_METHOD\nfrom OpenSSL.SSL import SysCallError\nfrom OpenSSL.SSL import TLSv1_1_METHOD\nfrom OpenSSL.SSL import TLSv1_2_METHOD\nfrom OpenSSL.SSL import TLSv1_METHOD\nfrom OpenSSL.SSL import WantReadError\nfrom OpenSSL.SSL import WantWriteError\nfrom OpenSSL.SSL import ZeroReturnError\nfrom OpenSSL.SSL import _make_requires\nfrom OpenSSL.SSL import OP_NO_TLSv1_3\n\n\ndef _create_certificate_chain(): [MASK]\n"}
